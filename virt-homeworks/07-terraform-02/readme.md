# Домашнее задание к занятию "Основы Terraform. Yandex Cloud"

## Выполнил Шарафуков Ильшат

### Задание 1:

```
Изучите проект. В файле variables.tf объявлены переменные для yandex provider.

Переименуйте файл personal.auto.tfvars_example в personal.auto.tfvars. 

Заполните переменные (идентификаторы облака, токен доступа). Благодаря .gitignore этот файл не попадет в публичный репозиторий. Вы можете выбрать иной способ безопасно передать секретные данные в terraform.

Сгенерируйте или используйте свой текущий ssh ключ. Запишите его открытую часть в переменную vms_ssh_root_key.

Инициализируйте проект, выполните код. Исправьте возникшую ошибку. Ответьте в чем заключается ее суть?

Ответьте, что означает preemptible = true и core_fraction в параметрах ВМ? Как это может пригодится в процессе обучения? Ответ в документации Yandex cloud.


В качестве решения приложите:
* скриншот ЛК Yandex Cloud с созданной ВМ,
* скриншот успешного подключения к консоли ВМ через ssh,
* ответы на вопросы.
```

### Ответы:

1. Изучил проект.
2. Переименовал файл, заполнил переменные.
3. Заложил в файл свой текущий ssh ключ.
4. Инициализировал проект, получил следующую ошибку:

![tf_error.png](img/1_1.png)

Суть в том, что для указанной платформы указано число ядер 1. Но выбрать можно либо 2, либо 4. Исправил на 2 и ВМ создалась.

![tf_success.png](img/1_3.png)

5. Ответы на вопросы:
* preemptible - ВМ, которая работает не более 24 часов и может быть остановлена Compute Cloud в любой момент. После остановки ВМ не удаляется, все ее данные сохраняются. Предоставляется с большой скидкой.
* core_fraction - Гарантированная доля vCPU, которая будет выделена ВМ. ВМ с гарантированной долей меньше 100% обеспечивают указанный уровень производительности с вероятностью временного повышения вплоть до 100%. Такие ВМ подходят для задач, которые не требуют постоянной гарантии производительности vCPU на 100%.

Скриншот созданной ВМ в ЛК:
![yc_vm_create.png](img/1_4.png)

Скриншот подключения к ВМ:
![vm_ssh.png](img/1_5.png)

### Задание 2:
```
Изучите файлы проекта.

Замените все "хардкод" значения для ресурсов yandex_compute_image и yandex_compute_instance на отдельные переменные. К названиям переменных ВМ добавьте в начало префикс vm_web_ . Пример: vm_web_name.

Объявите нужные переменные в файле variables.tf, обязательно указывайте тип переменной. Заполните их default прежними значениями из main.tf.

Проверьте terraform plan (изменений быть не должно).
```

### Ответы:

Добавил новые переменные:

![new_vars.png](img/2_1.png)

Заменил все "хардкод" значения:
![main_file_tf.png](img/2_2.png)

При применении terraform plan изменений не произошло:
![tf_plan.png](img/2_3.png)


### Задание 3:
```
Создайте в корне проекта файл 'vms_platform.tf' . Перенесите в него все переменные ВМ.

Скопируйте блок ресурса и создайте с его помощью вторую ВМ: "netology-develop-platform-db" , cores = 2, memory = 2, core_fraction = 20. Объявите ее переменные с префиксом vm_db_ в том же файле.

Примените изменения.
```

### Ответы:

Объявил новые переменные:
![new_vars.png](img/3_1.png)

Создал файл с новым ресурсом:
![new_vm_db.png](img/3_2.png)

И в конце создал ВМ:
![tf_apply_db.png](img/3_3.png)

### Задание 4:
```
Объявите в файле outputs.tf отдельные output, для каждой из ВМ с ее внешним IP адресом.

Примените изменения.

В качестве решения приложите вывод значений ip-адресов команды terraform output
```

### Ответы:

Создал файл outputs.tf:
![outputs_tf.png](img/4_1.png)

Вывод после tf apply:
![tf_after_apply.png](img/4_2.png)


### Задание 5:
```
В файле locals.tf опишите в одном local-блоке имя каждой ВМ, используйте интерполяцию по примеру из лекции.

Замените переменные с именами ВМ из файла variables.tf на созданные вами local переменные.

Примените изменения.
```

### Ответы: